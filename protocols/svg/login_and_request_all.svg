<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="2811px" preserveAspectRatio="none" style="width:1215px;height:2811px;" version="1.1" viewBox="0 0 1215 2811" width="1215px" zoomAndPan="magnify"><defs><filter height="300%" id="fh80g5rj7h1nr" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><line style="stroke: #A80036; stroke-width: 1.0;" x1="35" x2="35" y1="38.2969" y2="1896.3828"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="35" x2="35" y1="1896.3828" y2="1937.1875"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="35" x2="35" y1="1937.1875" y2="2090.9844"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="35" x2="35" y1="2090.9844" y2="2131.7891"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="35" x2="35" y1="2131.7891" y2="2246.4531"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="35" x2="35" y1="2246.4531" y2="2287.2578"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="35" x2="35" y1="2287.2578" y2="2771.3125"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="724" x2="724" y1="38.2969" y2="1896.3828"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="724" x2="724" y1="1896.3828" y2="1937.1875"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="724" x2="724" y1="1937.1875" y2="2090.9844"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="724" x2="724" y1="2090.9844" y2="2131.7891"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="724" x2="724" y1="2131.7891" y2="2246.4531"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="724" x2="724" y1="2246.4531" y2="2287.2578"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="724" x2="724" y1="2287.2578" y2="2771.3125"/><rect fill="#FEFECE" filter="url(#fh80g5rj7h1nr)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="51" x="8" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="15" y="22.9951">client</text><rect fill="#FEFECE" filter="url(#fh80g5rj7h1nr)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="51" x="8" y="2770.3125"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="15" y="2790.3076">client</text><rect fill="#FEFECE" filter="url(#fh80g5rj7h1nr)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="57" x="694" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="701" y="22.9951">server</text><rect fill="#FEFECE" filter="url(#fh80g5rj7h1nr)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="57" x="694" y="2770.3125"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="701" y="2790.3076">server</text><polygon fill="#A80036" points="712.5,141.0938,722.5,145.0938,712.5,149.0938,716.5,145.0938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="35.5" x2="718.5" y1="145.0938" y2="145.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="42.5" y="64.3638">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="56" x="50.5" y="79.4966">"login": {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="191" x="58.5" y="94.6294">"credentials": "my username",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="229" x="58.5" y="109.7622">"credentials_secret": "my password"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="50.5" y="124.895">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="42.5" y="140.0278">}</text><polygon fill="#A80036" points="46.5,255.7578,36.5,259.7578,46.5,263.7578,42.5,259.7578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="40.5" x2="723.5" y1="259.7578" y2="259.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="52.5" y="194.1606">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="60.5" y="209.2935">"login_accepted": {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="240" x="68.5" y="224.4263">"timestamp": 1600335764183279616</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="60.5" y="239.5591">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="52.5" y="254.6919">}</text><polygon fill="#A80036" points="46.5,400.6875,36.5,404.6875,46.5,408.6875,42.5,404.6875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="40.5" x2="723.5" y1="404.6875" y2="404.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="52.5" y="308.8247">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="60.5" y="323.9575">"session_started": {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="244" x="68.5" y="339.0903">"timestamp": 1600335764183573504,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="120" x="68.5" y="354.2231">"session_id": 1001,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="177" x="68.5" y="369.356">"default_channel_id": 12345</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="60.5" y="384.4888">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="52.5" y="399.6216">}</text><path d="M729,442.6875 L729,482.6875 L1187,482.6875 L1187,452.6875 L1177,442.6875 L729,442.6875 " fill="#FBFB77" filter="url(#fh80g5rj7h1nr)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1177,442.6875 L1177,452.6875 L1187,452.6875 L1177,442.6875 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="437" x="735" y="459.7544">The initial handshake is complete. From now on the client and server</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="364" x="735" y="474.8872">must check timeouts and send heartbeats as necessary.</text><path d="M40,496.9531 L40,551.9531 L401,551.9531 L401,506.9531 L391,496.9531 L40,496.9531 " fill="#FBFB77" filter="url(#fh80g5rj7h1nr)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M391,496.9531 L391,506.9531 L401,506.9531 L391,496.9531 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="336" x="46" y="514.02">A channel represents a set of sequenced messages.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="50" y="529.1528"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="340" x="46" y="544.2856">There will be a new channel_id created for each cycle.</text><polygon fill="#A80036" points="46.5,699.5469,36.5,703.5469,46.5,707.5469,42.5,703.5469" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="40.5" x2="723.5" y1="703.5469" y2="703.5469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="52.5" y="577.4185">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="123" x="60.5" y="592.5513">"channel_added": {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="244" x="68.5" y="607.6841">"timestamp": 1600335764183869952,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="68.5" y="622.8169">"channel_id": 12345,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="68.5" y="637.9497">"next_sequence_number": 4,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="195" x="68.5" y="653.0825">"oldest_sequence_number": 1,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="175" x="68.5" y="668.2153">"default_stream_id": "none"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="60.5" y="683.3481">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="52.5" y="698.481">}</text><path d="M40,741.5469 L40,932.5469 L548,932.5469 L548,751.5469 L538,741.5469 L40,741.5469 " fill="#FBFB77" filter="url(#fh80g5rj7h1nr)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M538,741.5469 L538,751.5469 L548,751.5469 L538,741.5469 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="434" x="46" y="758.6138">No application messages will be sent until a request_stream is sent.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="50" y="773.7466"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="196" x="46" y="788.8794">In a request_stream message:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="50" y="804.0122"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="476" x="46" y="819.145">- The channel_id must match the value from the channel_added message.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="50" y="834.2778"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="478" x="46" y="849.4106">- A begin_sequence_number of 1 means start from the very first message.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="50" y="864.5435"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="487" x="46" y="879.6763">- An end_sequence_number of "none" means send future messages as well.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="50" y="894.8091"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="441" x="46" y="909.9419">- The stream_id is an arbitrary number assigned by the client used to</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="390" x="46" y="925.0747">match the requests with later responses like stream_started.</text><polygon fill="#A80036" points="712.5,1065.2031,722.5,1069.2031,712.5,1073.2031,716.5,1069.2031" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="35.5" x2="718.5" y1="1069.2031" y2="1069.2031"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="42.5" y="958.2075">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="50.5" y="973.3403">"request_stream": {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="58.5" y="988.4731">"channel_id": 12345,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="191" x="58.5" y="1003.606">"begin_sequence_number": 1,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="214" x="58.5" y="1018.7388">"end_sequence_number": "none",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="90" x="58.5" y="1033.8716">"stream_id": 1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="50.5" y="1049.0044">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="42.5" y="1064.1372">}</text><polygon fill="#A80036" points="46.5,1240.3984,36.5,1244.3984,46.5,1248.3984,42.5,1244.3984" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="40.5" x2="723.5" y1="1244.3984" y2="1244.3984"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="52.5" y="1118.27">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="125" x="60.5" y="1133.4028">"stream_started": {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="244" x="68.5" y="1148.5356">"timestamp": 1600335764184578816,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="68.5" y="1163.6685">"channel_id": 12345,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="191" x="68.5" y="1178.8013">"begin_sequence_number": 1,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="214" x="68.5" y="1193.9341">"end_sequence_number": "none",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="90" x="68.5" y="1209.0669">"stream_id": 1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="60.5" y="1224.1997">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="52.5" y="1239.3325">}</text><path d="M729,1282.3984 L729,1322.3984 L1203,1322.3984 L1203,1292.3984 L1193,1282.3984 L729,1282.3984 " fill="#FBFB77" filter="url(#fh80g5rj7h1nr)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1193,1282.3984 L1193,1292.3984 L1203,1292.3984 L1193,1282.3984 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="453" x="735" y="1299.4653">The request/response phase of this session-layer scenario is complete.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="358" x="735" y="1314.5981">From now on messages are exchanged asynchronously.</text><path d="M40,1336.6641 L40,1406.6641 L491,1406.6641 L491,1346.6641 L481,1336.6641 L40,1336.6641 " fill="#FBFB77" filter="url(#fh80g5rj7h1nr)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M481,1336.6641 L481,1346.6641 L491,1346.6641 L481,1336.6641 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="286" x="46" y="1353.731">Application messages follow stream_started.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="50" y="1368.8638"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="430" x="46" y="1383.9966">The first application message will have the sequence number of the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="375" x="46" y="1399.1294">preceding stream_started's begin_sequence_number field.</text><polygon fill="#A80036" points="46.5,1539.2578,36.5,1543.2578,46.5,1547.2578,42.5,1543.2578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="40.5" x2="723.5" y1="1543.2578" y2="1543.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="52.5" y="1432.2622">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="60.5" y="1447.395">"deliverable": {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="68.5" y="1462.5278">"deliverable_id": 1,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="105" x="68.5" y="1477.6606">"symbol": "AAA",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="68.5" y="1492.7935">"decimal_places": 2,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="649" x="68.5" y="1507.9263">"token_address": "0x0000000000000000000000000000000000000000000000000000000000000000"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="60.5" y="1523.0591">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="52.5" y="1538.1919">}</text><polygon fill="#A80036" points="46.5,1699.3203,36.5,1703.3203,46.5,1707.3203,42.5,1703.3203" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="40.5" x2="723.5" y1="1703.3203" y2="1703.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="52.5" y="1592.3247">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="60.5" y="1607.4575">"deliverable": {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="68.5" y="1622.5903">"deliverable_id": 2,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="105" x="68.5" y="1637.7231">"symbol": "BBB",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="68.5" y="1652.856">"decimal_places": 0,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="649" x="68.5" y="1667.9888">"token_address": "0x0000000000000000000000000000000000000000000000000000000000000000"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="60.5" y="1683.1216">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="52.5" y="1698.2544">}</text><polygon fill="#A80036" points="46.5,1859.3828,36.5,1863.3828,46.5,1867.3828,42.5,1863.3828" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="40.5" x2="723.5" y1="1863.3828" y2="1863.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="52.5" y="1752.3872">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="60.5" y="1767.52">"deliverable": {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="68.5" y="1782.6528">"deliverable_id": 3,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="105" x="68.5" y="1797.7856">"symbol": "CCC",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="68.5" y="1812.9185">"decimal_places": 0,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="649" x="68.5" y="1828.0513">"token_address": "0x0000000000000000000000000000000000000000000000000000000000000000"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="60.5" y="1843.1841">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="52.5" y="1858.3169">}</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="71" x="344.5" y="1920.5933">time passes</text><path d="M40,1942.1875 L40,1967.1875 L471,1967.1875 L471,1952.1875 L461,1942.1875 L40,1942.1875 " fill="#FBFB77" filter="url(#fh80g5rj7h1nr)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M461,1942.1875 L461,1952.1875 L471,1952.1875 L461,1942.1875 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="410" x="46" y="1959.2544">Both ends of the connection must periodically send a heartbeat.</text><polygon fill="#A80036" points="46.5,2053.9844,36.5,2057.9844,46.5,2061.9844,42.5,2057.9844" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="40.5" x2="723.5" y1="2057.9844" y2="2057.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="52.5" y="1992.3872">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="60.5" y="2007.52">"heartbeat": {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="240" x="68.5" y="2022.6528">"timestamp": 1600335769188541440</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="60.5" y="2037.7856">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="52.5" y="2052.9185">}</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="71" x="344.5" y="2115.1948">time passes</text><polygon fill="#A80036" points="712.5,2209.4531,722.5,2213.4531,712.5,2217.4531,716.5,2213.4531" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="35.5" x2="718.5" y1="2213.4531" y2="2213.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="42.5" y="2147.856">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="50.5" y="2162.9888">"heartbeat": {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="240" x="58.5" y="2178.1216">"timestamp": 1600335771491483648</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="50.5" y="2193.2544">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="42.5" y="2208.3872">}</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="71" x="344.5" y="2270.6636">time passes</text><path d="M40,2292.2578 L40,2347.2578 L517,2347.2578 L517,2302.2578 L507,2292.2578 L40,2292.2578 " fill="#FBFB77" filter="url(#fh80g5rj7h1nr)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M507,2292.2578 L507,2302.2578 L517,2302.2578 L507,2292.2578 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="452" x="46" y="2309.3247">The stream_resumed message is normally used for switching streams,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="420" x="46" y="2324.4575">but if necessary we will make it configurable for the server to send</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="378" x="46" y="2339.5903">it before every Nth application message (e.g. with N == 1).</text><polygon fill="#A80036" points="46.5,2479.7188,36.5,2483.7188,46.5,2487.7188,42.5,2483.7188" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="40.5" x2="723.5" y1="2483.7188" y2="2483.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="52.5" y="2372.7231">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="136" x="60.5" y="2387.856">"stream_resumed": {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="244" x="68.5" y="2402.9888">"timestamp": 1600335772492590336,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="68.5" y="2418.1216">"channel_id": 12345,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="68.5" y="2433.2544">"next_sequence_number": 4,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="90" x="68.5" y="2448.3872">"stream_id": 1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="60.5" y="2463.52">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="52.5" y="2478.6528">}</text><path d="M40,2521.7188 L40,2591.7188 L491,2591.7188 L491,2531.7188 L481,2521.7188 L40,2521.7188 " fill="#FBFB77" filter="url(#fh80g5rj7h1nr)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M481,2521.7188 L481,2531.7188 L491,2531.7188 L481,2521.7188 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="297" x="46" y="2538.7856">Application messages follow stream_resumed.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="50" y="2553.9185"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="430" x="46" y="2569.0513">The first application message will have the sequence number of the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="379" x="46" y="2584.1841">preceding stream_resumed's next_sequence_number field.</text><polygon fill="#A80036" points="46.5,2724.3125,36.5,2728.3125,46.5,2732.3125,42.5,2728.3125" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="40.5" x2="723.5" y1="2728.3125" y2="2728.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="52.5" y="2617.3169">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="95" x="60.5" y="2632.4497">"deliverable": {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="68.5" y="2647.5825">"deliverable_id": 4,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="108" x="68.5" y="2662.7153">"symbol": "DDD",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="68.5" y="2677.8481">"decimal_places": 0,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="649" x="68.5" y="2692.981">"token_address": "0x0000000000000000000000000000000000000000000000000000000000000000"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="60.5" y="2708.1138">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="52.5" y="2723.2466">}</text><!--MD5=[1f669982a9b47926e241af4c9ce25435]
@startuml
"client" -> "server" : {\n  "login": {\n    "credentials": "my username",\n    "credentials_secret": "my password"\n  }\n}
|||
"client" <- "server" : {\n  "login_accepted": {\n    "timestamp": 1600335764183279616\n  }\n}
|||
"client" <- "server" : {\n  "session_started": {\n    "timestamp": 1600335764183573504,\n    "session_id": 1001,\n    "default_channel_id": 12345\n  }\n}
|||
note right of "server" : The initial handshake is complete. From now on the client and server\nmust check timeouts and send heartbeats as necessary.
note right of "client" : A channel represents a set of sequenced messages.\n\nThere will be a new channel_id created for each cycle.
"client" <- "server" : {\n  "channel_added": {\n    "timestamp": 1600335764183869952,\n    "channel_id": 12345,\n    "next_sequence_number": 4,\n    "oldest_sequence_number": 1,\n    "default_stream_id": "none"\n  }\n}
|||
note right of "client" : No application messages will be sent until a request_stream is sent.\n\nIn a request_stream message:\n\n- The channel_id must match the value from the channel_added message.\n\n- A begin_sequence_number of 1 means start from the very first message.\n\n- An end_sequence_number of "none" means send future messages as well.\n\n- The stream_id is an arbitrary number assigned by the client used to\nmatch the requests with later responses like stream_started.
"client" -> "server" : {\n  "request_stream": {\n    "channel_id": 12345,\n    "begin_sequence_number": 1,\n    "end_sequence_number": "none",\n    "stream_id": 1\n  }\n}
|||
"client" <- "server" : {\n  "stream_started": {\n    "timestamp": 1600335764184578816,\n    "channel_id": 12345,\n    "begin_sequence_number": 1,\n    "end_sequence_number": "none",\n    "stream_id": 1\n  }\n}
|||
note right of "server" : The request/response phase of this session-layer scenario is complete.\nFrom now on messages are exchanged asynchronously.
note right of "client" : Application messages follow stream_started.\n\nThe first application message will have the sequence number of the\npreceding stream_started's begin_sequence_number field.
"client" <- "server" : {\n  "deliverable": {\n    "deliverable_id": 1,\n    "symbol": "AAA",\n    "decimal_places": 2,\n    "token_address": "0x0000000000000000000000000000000000000000000000000000000000000000"\n  }\n}
|||
"client" <- "server" : {\n  "deliverable": {\n    "deliverable_id": 2,\n    "symbol": "BBB",\n    "decimal_places": 0,\n    "token_address": "0x0000000000000000000000000000000000000000000000000000000000000000"\n  }\n}
|||
"client" <- "server" : {\n  "deliverable": {\n    "deliverable_id": 3,\n    "symbol": "CCC",\n    "decimal_places": 0,\n    "token_address": "0x0000000000000000000000000000000000000000000000000000000000000000"\n  }\n}
|||
...time passes...
note right of "client" : Both ends of the connection must periodically send a heartbeat.
"client" <- "server" : {\n  "heartbeat": {\n    "timestamp": 1600335769188541440\n  }\n}
|||
...time passes...
"client" -> "server" : {\n  "heartbeat": {\n    "timestamp": 1600335771491483648\n  }\n}
|||
...time passes...
note right of "client" : The stream_resumed message is normally used for switching streams, \nbut if necessary we will make it configurable for the server to send\nit before every Nth application message (e.g. with N == 1).
"client" <- "server" : {\n  "stream_resumed": {\n    "timestamp": 1600335772492590336,\n    "channel_id": 12345,\n    "next_sequence_number": 4,\n    "stream_id": 1\n  }\n}
|||
note right of "client" : Application messages follow stream_resumed.\n\nThe first application message will have the sequence number of the\npreceding stream_resumed's next_sequence_number field.
"client" <- "server" : {\n  "deliverable": {\n    "deliverable_id": 4,\n    "symbol": "DDD",\n    "decimal_places": 0,\n    "token_address": "0x0000000000000000000000000000000000000000000000000000000000000000"\n  }\n}
|||
@enduml

PlantUML version 1.2020.02(Sun Mar 01 21:22:07 AEDT 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.8+10-post-Debian-1
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: AU
--></g></svg>